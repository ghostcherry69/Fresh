<%= render 'layouts/userheader' %>

  <main>
    <div class="container">
      <div class="row">
        <div class="col-xs-3">
          <table>
            <thead>
              <tr>
                <th>ジャンル検索</th>
              </tr>
            </thead>

            <tbody>
              <% @genres.each do |genre| %>
                <tr>
                  <td><%= link_to genre.name, public_products_path(genre_id: genre.id) %></td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>

        <div class="col-xs-9">
          <div class="product-show">
            <%= attachment_image_tag @product, :image, :fill, 100, 100, format: 'jpeg', fallback: "no_image.jpg", size: "150x150" %>
            <label>【商品名】</label>
            <%= @product.name %><br>
            <label>【商品説明文】</label><br>
            <%= @product.explanation %><br>
            <label>【税込価格】</label>
            <%= ((@product.price_excluding_tax * 1.1).round).to_s(:delimited, delimiter: ',') %>(税込)<br>

              <%= form_with model: [:public, @new_product_in_cart], url:{controller: :product_in_carts, action: :create}, local: true do |f| %>
                <% if @new_product_in_cart.errors.any? %>
                  <h3 class="error"><%= @new_product_in_cart.errors.count %>件のエラーがあります。</h3>
                  <ul>
                  <% @new_product_in_cart.errors.full_messages.each do |message| %>
                    <li><%= message %></li>
                  <% end %>
                  </ul>
                <% end %>
              <%= f.select :quantity, @stock_quantity_array, include_blank: "個数選択" %><br>
              <%= f.hidden_field :product_id, :value => @product.id %>
              <%= f.submit 'カートに入れる' %>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </main>

<%= render 'layouts/userfooter' %>